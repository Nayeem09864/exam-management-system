<div class="dashboard-container">
  <header class="dashboard-header">
    <div class="header-content">
      <h1>Exam Management System</h1>
      <nav class="nav-menu">
        <a routerLink="/dashboard" routerLinkActive="active">Dashboard</a>
        <a routerLink="/questions" routerLinkActive="active">Questions</a>
      </nav>
      <div class="user-info">
        <span class="username">Welcome, {{ getUsername() }} ({{ getRole() }})</span>
        <button class="btn btn-secondary" (click)="logout()">Logout</button>
      </div>
    </div>
  </header>

  <main class="dashboard-main">
    <div *ngIf="isLoading" class="loading">
      <p>Loading dashboard...</p>
    </div>

    <div *ngIf="errorMessage" class="alert alert-error">
      {{ errorMessage }}
    </div>

    <div *ngIf="!isLoading && !errorMessage && dashboardData" class="dashboard-content">
      <!-- Statistics Cards -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">üìä</div>
          <div class="stat-content">
            <h3>{{ dashboardData.totalExams || 0 }}</h3>
            <p>Total Exams</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">üë•</div>
          <div class="stat-content">
            <h3>{{ dashboardData.totalCandidates || 0 }}</h3>
            <p>Total Candidates</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">‚ùì</div>
          <div class="stat-content">
            <h3>{{ dashboardData.totalQuestions || 0 }}</h3>
            <p>Total Questions</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">üìù</div>
          <div class="stat-content">
            <h3>{{ dashboardData.totalAttempts || 0 }}</h3>
            <p>Total Attempts</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">‚úÖ</div>
          <div class="stat-content">
            <h3>{{ dashboardData.submittedAttempts || 0 }}</h3>
            <p>Submitted Attempts</p>
          </div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="section">
        <h2>Quick Actions</h2>
        <div class="quick-actions">
          <a routerLink="/questions/create" class="action-card">
            <div class="action-icon">‚ùì</div>
            <div class="action-content">
              <h3>Create Question</h3>
              <p>Add a new question to the question bank</p>
            </div>
          </a>
          <a routerLink="/questions" class="action-card">
            <div class="action-icon">üìö</div>
            <div class="action-content">
              <h3>Question Bank</h3>
              <p>View and manage all questions</p>
            </div>
          </a>
        </div>
      </div>

      <!-- Exams Section -->
      <div class="section">
        <h2>Exams</h2>
        <div *ngIf="dashboardData.exams && dashboardData.exams.length > 0; else noExams" class="exams-list">
          <div *ngFor="let exam of dashboardData.exams" class="exam-card">
            <div class="exam-header">
              <h3>{{ exam.examName }}</h3>
              <span class="badge" [class.active]="exam.isActive" [class.inactive]="!exam.isActive">
                {{ exam.isActive ? 'Active' : 'Inactive' }}
              </span>
            </div>
            <div class="exam-details">
              <p><strong>Access Code:</strong> {{ exam.accessCode }}</p>
              <p><strong>Questions:</strong> {{ exam.totalQuestions }}</p>
              <p><strong>Duration:</strong> {{ exam.durationMinutes }} minutes</p>
              <p><strong>Candidates:</strong> {{ exam.totalCandidates || 0 }}</p>
              <p><strong>Attempts:</strong> {{ exam.totalAttempts || 0 }} ({{ exam.submittedAttempts || 0 }} submitted)</p>
              <p *ngIf="exam.averageScore !== undefined"><strong>Average Score:</strong> {{ exam.averageScore }}%</p>
              <p *ngIf="exam.createdAt"><strong>Created:</strong> {{ exam.createdAt }}</p>
            </div>
          </div>
        </div>
        <ng-template #noExams>
          <div class="empty-state">
            <p>No exams created yet. Create your first exam to get started.</p>
          </div>
        </ng-template>
      </div>

      <!-- Recent Results Section -->
      <div class="section" *ngIf="dashboardData.recentResults && dashboardData.recentResults.length > 0">
        <h2>Recent Results</h2>
        <div class="results-table">
          <table>
            <thead>
              <tr>
                <th>Exam</th>
                <th>Candidate</th>
                <th>Score</th>
                <th>Correct</th>
                <th>Wrong</th>
                <th>Total</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let result of dashboardData.recentResults">
                <td>{{ result.examName }}</td>
                <td>{{ result.candidateName }}<br><small>{{ result.candidateEmail }}</small></td>
                <td><strong>{{ result.percentage }}%</strong></td>
                <td class="correct">{{ result.correctAnswers }}</td>
                <td class="wrong">{{ result.wrongAnswers }}</td>
                <td>{{ result.totalQuestions }}</td>
                <td>{{ result.evaluatedAt }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </main>
</div>
